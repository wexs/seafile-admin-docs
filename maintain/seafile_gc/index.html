
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://haiwen.github.io/seafile-admin-docs/maintain/seafile_gc/">
      
      
        <meta name="author" content="seafile">
      
      <link rel="shortcut icon" href="../../media/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.7">
    
    
      
        <title>Seafile GC - Seafile admin manual</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.19753c6b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.196e0c26.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#seafile-gc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://haiwen.github.io/seafile-admin-docs/" title="Seafile admin manual" class="md-header-nav__button md-logo" aria-label="Seafile admin manual">
      
  <img src="../../media/seafile-transparent-1024.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Seafile admin manual
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Seafile GC
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/haiwen/seafile-admin-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    haiwen/seafile-admin-docs
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://haiwen.github.io/seafile-admin-docs/" title="Seafile admin manual" class="md-nav__button md-logo" aria-label="Seafile admin manual">
      
  <img src="../../media/seafile-transparent-1024.png" alt="logo">

    </a>
    Seafile admin manual
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/haiwen/seafile-admin-docs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    haiwen/seafile-admin-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" >
    <label class="md-nav__link" for="nav-1">
      Overview
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Overview" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/components/" class="md-nav__link">
      Seafile Components
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../overview/file_permission_management/" class="md-nav__link">
      File permission management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../roadmap/" class="md-nav__link">
      Roadmap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../faq/" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contribution/" class="md-nav__link">
      Contribution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../changelog/" class="md-nav__link">
      Changelog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
    <label class="md-nav__link" for="nav-2">
      Deploy Seafile under Linux
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Deploy Seafile under Linux" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Deploy Seafile under Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/" class="md-nav__link">
      Forward
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/using_sqlite/" class="md-nav__link">
      Deploy with SQLite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/using_mysql/" class="md-nav__link">
      Deploy with MySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/deploy_with_docker/" class="md-nav__link">
      Deploy with Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/deploy_with_nginx/" class="md-nav__link">
      Config Seahub with Nginx
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/https_with_nginx/" class="md-nav__link">
      Enabling Https with Nginx
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/deploy_with_apache/" class="md-nav__link">
      Config Seahub with Apache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/https_with_apache/" class="md-nav__link">
      Enabling Https with Apache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/using_ldap/" class="md-nav__link">
      LDAP/AD Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10" >
    <label class="md-nav__link" for="nav-2-10">
      Single Sign On
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Single Sign On" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        <span class="md-nav__icon md-icon"></span>
        Single Sign On
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/single_sign_on/" class="md-nav__link">
      Forward
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/shibboleth_config/" class="md-nav__link">
      Shibboleth Authentication for Seafile v6.2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/shibboleth_config_v6.3/" class="md-nav__link">
      Shibboleth Authentication for Seafile v6.3+
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/oauth/" class="md-nav__link">
      OAuth Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/remote_user/" class="md-nav__link">
      Remote User Authentication
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/using_syslog/" class="md-nav__link">
      Syslog Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-12" type="checkbox" id="nav-2-12" >
    <label class="md-nav__link" for="nav-2-12">
      Online File Preview and Edit
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Online File Preview and Edit" data-md-level="2">
      <label class="md-nav__title" for="nav-2-12">
        <span class="md-nav__icon md-icon"></span>
        Online File Preview and Edit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/libreoffice_online/" class="md-nav__link">
      LibreOffice Online Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/only_office/" class="md-nav__link">
      OnlyOffice Integration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/ocm/" class="md-nav__link">
      Open Cloud Mesh
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-14" type="checkbox" id="nav-2-14" >
    <label class="md-nav__link" for="nav-2-14">
      Other Deployment Notes
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Other Deployment Notes" data-md-level="2">
      <label class="md-nav__title" for="nav-2-14">
        <span class="md-nav__icon md-icon"></span>
        Other Deployment Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/start_seafile_at_system_bootup/" class="md-nav__link">
      Start Seafile at System Bootup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/using_firewall/" class="md-nav__link">
      Firewall settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/using_logrotate/" class="md-nav__link">
      Logrotate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/add_memcached/" class="md-nav__link">
      Add Memcached
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/deploy_seafile_behind_nat/" class="md-nav__link">
      Deploy Seafile behind NAT
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/deploy_seahub_at_non-root_domain/" class="md-nav__link">
      Deploy Seahub at Non-root domain
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy/migrate_from_sqlite_to_mysql/" class="md-nav__link">
      Migrate From SQLite to MySQL
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../faq/" class="md-nav__link">
      Common Problems for Setting up Server
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    <label class="md-nav__link" for="nav-3">
      Deploy Seafile Pro Edition
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Deploy Seafile Pro Edition" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Deploy Seafile Pro Edition
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/" class="md-nav__link">
      Forward
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/download_and_setup_seafile_professional_server/" class="md-nav__link">
      Download and Setup Seafile Professional Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/deploy_with_docker/" class="md-nav__link">
      Deploy Seafile-pro with Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/migrate_from_seafile_community_server/" class="md-nav__link">
      Migrate from Seafile Community Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/upgrading_seafile_professional_server/" class="md-nav__link">
      Upgrading Seafile Professional Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6" >
    <label class="md-nav__link" for="nav-3-6">
      LDAP/AD Integration
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="LDAP/AD Integration" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        <span class="md-nav__icon md-icon"></span>
        LDAP/AD Integration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/using_ldap_pro/" class="md-nav__link">
      LDAP Configuration for Seafile Pro
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/ldap_group_sync/" class="md-nav__link">
      Importing Groups from LDAP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/ldap_role_sync/" class="md-nav__link">
      Importing Roles from LDAP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7" >
    <label class="md-nav__link" for="nav-3-7">
      Online File Preview and Edit
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Online File Preview and Edit" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        <span class="md-nav__icon md-icon"></span>
        Online File Preview and Edit
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/office_documents_preview/" class="md-nav__link">
      Office Documents Preview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/office_web_app/" class="md-nav__link">
      Office Online Server Integration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/details_about_file_search/" class="md-nav__link">
      File Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9" >
    <label class="md-nav__link" for="nav-3-9">
      Virus Scan
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Virus Scan" data-md-level="2">
      <label class="md-nav__title" for="nav-3-9">
        <span class="md-nav__icon md-icon"></span>
        Virus Scan
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/virus_scan/" class="md-nav__link">
      Forward
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/deploy_clamav_as_daemon/" class="md-nav__link">
      Run ClamAV as a Daemon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/virus_scan_with_kav4fs/" class="md-nav__link">
      Virus Scan With Kav4fs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-10" type="checkbox" id="nav-3-10" >
    <label class="md-nav__link" for="nav-3-10">
      Storage Backends
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Storage Backends" data-md-level="2">
      <label class="md-nav__title" for="nav-3-10">
        <span class="md-nav__icon md-icon"></span>
        Storage Backends
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/setup_with_amazon_s3/" class="md-nav__link">
      Amazon S3 Backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/setup_with_ceph/" class="md-nav__link">
      Ceph Backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/setup_with_swift/" class="md-nav__link">
      OpenStack Swift Backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/multiple_storage_backends/" class="md-nav__link">
      Multiple Storage Backends
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/migrate/" class="md-nav__link">
      Data migration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-11" type="checkbox" id="nav-3-11" >
    <label class="md-nav__link" for="nav-3-11">
      Cluster Deployment
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Cluster Deployment" data-md-level="2">
      <label class="md-nav__title" for="nav-3-11">
        <span class="md-nav__icon md-icon"></span>
        Cluster Deployment
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/deploy_in_a_cluster/" class="md-nav__link">
      Deploy in a cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/enable_search_and_background_tasks_in_a_cluster/" class="md-nav__link">
      Search and background tasks in a cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/memcached_mariadb_cluster/" class="md-nav__link">
      Memcache and MariaDB Cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/setup_seafile_cluster_with_nfs/" class="md-nav__link">
      Setup Seafile cluster with NFS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/upgrade_a_cluster/" class="md-nav__link">
      Upgrade a cluster
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-12" type="checkbox" id="nav-3-12" >
    <label class="md-nav__link" for="nav-3-12">
      Advanced User Management
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Advanced User Management" data-md-level="2">
      <label class="md-nav__title" for="nav-3-12">
        <span class="md-nav__icon md-icon"></span>
        Advanced User Management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/multi_institutions/" class="md-nav__link">
      Multi-Institutions Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/roles_permissions/" class="md-nav__link">
      Roles and Permissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/admin_roles_permissions/" class="md-nav__link">
      Administrator Roles and Permissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/multi_tenancy/" class="md-nav__link">
      Multi-Tenancy Support
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-13" type="checkbox" id="nav-3-13" >
    <label class="md-nav__link" for="nav-3-13">
      Advanced Authentication
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Advanced Authentication" data-md-level="2">
      <label class="md-nav__title" for="nav-3-13">
        <span class="md-nav__icon md-icon"></span>
        Advanced Authentication
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/two_factor_authentication/" class="md-nav__link">
      Two-factor Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/adfs/" class="md-nav__link">
      ADFS or SAML 2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/cas/" class="md-nav__link">
      CAS Authentication
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-14" type="checkbox" id="nav-3-14" >
    <label class="md-nav__link" for="nav-3-14">
      Advanced Maintenance Tools
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Advanced Maintenance Tools" data-md-level="2">
      <label class="md-nav__title" for="nav-3-14">
        <span class="md-nav__icon md-icon"></span>
        Advanced Maintenance Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/real_time_backup/" class="md-nav__link">
      Real-time Backup Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/seaf_import/" class="md-nav__link">
      Import Directory To Seafile
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deploy_pro/seafile_professional_sdition_software_license_agreement/" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    <label class="md-nav__link" for="nav-4">
      Deploy Seafile with Docker
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Deploy Seafile with Docker" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Deploy Seafile with Docker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/deploy%20seafile%20with%20docker/" class="md-nav__link">
      Deploy Seafile with Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/pro-edition/Deploy%20Seafile-pro%20with%20Docker/" class="md-nav__link">
      Deploy Seafile Pro Edition with Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/pro-edition/Migrate%20CE%20to%20Pro%20with%20Docker/" class="md-nav__link">
      Migrate CE to Pro with Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4" >
    <label class="md-nav__link" for="nav-4-4">
      Upgrade from 6.3 to 7.0
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Upgrade from 6.3 to 7.0" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        <span class="md-nav__icon md-icon"></span>
        Upgrade from 6.3 to 7.0
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/6.3%20upgrade%20to%207.0/" class="md-nav__link">
      Upgrade Seafile Docker CE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/pro-edition/6.3%20upgrade%20to%207.0/" class="md-nav__link">
      Upgrade Seafile Docker Pro
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5" >
    <label class="md-nav__link" for="nav-4-5">
      Upgrade for other versions
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Upgrade for other versions" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        <span class="md-nav__icon md-icon"></span>
        Upgrade for other versions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/upgrade/7.0_7.1/" class="md-nav__link">
      7.0 to 7.1
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" >
    <label class="md-nav__link" for="nav-5">
      Configuration and Customization
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Configuration and Customization" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Configuration and Customization
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../config/" class="md-nav__link">
      Forward
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../config/ccnet-conf/" class="md-nav__link">
      ccnet.conf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../config/seafile-conf/" class="md-nav__link">
      seafile.conf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../config/seahub_settings_py/" class="md-nav__link">
      seahub_settings.py
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../config/seafevents-conf/" class="md-nav__link">
      seafevents.conf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../config/seahub_customization/" class="md-nav__link">
      Seahub customization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../config/sending_email/" class="md-nav__link">
      Email Sending
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    <label class="md-nav__link" for="nav-6">
      Administration
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Administration" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Administration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" class="md-nav__link">
      Forward
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../account/" class="md-nav__link">
      Account management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../logs/" class="md-nav__link">
      Logs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../backup_recovery/" class="md-nav__link">
      Backup and Recovery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../seafile_fsck/" class="md-nav__link">
      Seafile FSCK
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Seafile GC
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Seafile GC
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#run-gc" class="md-nav__link">
    Run GC
  </a>
  
    <nav class="md-nav" aria-label="Run GC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dry-run-mode" class="md-nav__link">
    Dry-run Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-garbage" class="md-nav__link">
    Removing Garbage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-multiple-threads-in-gc" class="md-nav__link">
    Using Multiple Threads in GC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-gc-based-on-library-id-prefix" class="md-nav__link">
    Run GC based on library ID prefix
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gc-cleanup-script-for-community-version" class="md-nav__link">
    GC cleanup script for Community Version
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gc-in-the-seafile-docker-container" class="md-nav__link">
    GC in the seafile docker container
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../clean_database/" class="md-nav__link">
      Clean database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../export_report/" class="md-nav__link">
      Export report
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
    <label class="md-nav__link" for="nav-7">
      Upgrade Seafile server
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Upgrade Seafile server" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Upgrade Seafile server
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../upgrade/upgrade/" class="md-nav__link">
      Forward
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../upgrade/upgrade_notes_for_5.x.x/" class="md-nav__link">
      Upgrade notes for 5.x.x
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../upgrade/upgrade_notes_for_6.x.x/" class="md-nav__link">
      Upgrade notes for 6.x.x
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../upgrade/upgrade_notes_for_7.0.x/" class="md-nav__link">
      Upgrade notes for 7.0.x
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../upgrade/upgrade_notes_for_7.1.x/" class="md-nav__link">
      Upgrade notes for 7.1.x
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8" >
    <label class="md-nav__link" for="nav-8">
      WebDAV and FUSE extensions
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="WebDAV and FUSE extensions" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        WebDAV and FUSE extensions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../extension/" class="md-nav__link">
      Forward
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../extension/webdav/" class="md-nav__link">
      WebDAV extension
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../extension/fuse/" class="md-nav__link">
      FUSE extension
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" >
    <label class="md-nav__link" for="nav-9">
      Security and Auditing
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Security and Auditing" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        Security and Auditing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../security/security_features/" class="md-nav__link">
      Security features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../security/auditing/" class="md-nav__link">
      Access logs and auditing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../security/fail2ban/" class="md-nav__link">
      Config fail2ban
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10" >
    <label class="md-nav__link" for="nav-10">
      Developing
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Developing" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon"></span>
        Developing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/" class="md-nav__link">
      Forward
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10-2" type="checkbox" id="nav-10-2" >
    <label class="md-nav__link" for="nav-10-2">
      How to Build Seafile
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="How to Build Seafile" data-md-level="2">
      <label class="md-nav__title" for="nav-10-2">
        <span class="md-nav__icon md-icon"></span>
        How to Build Seafile
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../build_seafile/" class="md-nav__link">
      Forward
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../build_seafile/linux/" class="md-nav__link">
      Linux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../build_seafile/freebsd/" class="md-nav__link">
      FreeBSD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../build_seafile/osx/" class="md-nav__link">
      Mac OS X
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../build_seafile/server/" class="md-nav__link">
      Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../build_seafile/rpi/" class="md-nav__link">
      Raspberry Pi
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/env/" class="md-nav__link">
      Develop env
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/translation/" class="md-nav__link">
      Translation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/web_api_v2.1/" class="md-nav__link">
      Web API V2.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/python_api/" class="md-nav__link">
      Python API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/rene-s/Seafile-PHP-SDK" class="md-nav__link">
      PHP API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/data_model/" class="md-nav__link">
      Data Model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../develop/server-components/" class="md-nav__link">
      Server Components
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11" >
    <label class="md-nav__link" for="nav-11">
      ChangeLog
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="ChangeLog" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        <span class="md-nav__icon md-icon"></span>
        ChangeLog
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../changelog/server-changelog/" class="md-nav__link">
      Seafile Community Edition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../changelog/changelog-for-seafile-professional-server/" class="md-nav__link">
      Seafile Professional Edition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../changelog/client-changelog/" class="md-nav__link">
      Seafile Client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../changelog/drive-client-changelog/" class="md-nav__link">
      Drive Client ChangeLog
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#run-gc" class="md-nav__link">
    Run GC
  </a>
  
    <nav class="md-nav" aria-label="Run GC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dry-run-mode" class="md-nav__link">
    Dry-run Mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-garbage" class="md-nav__link">
    Removing Garbage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-multiple-threads-in-gc" class="md-nav__link">
    Using Multiple Threads in GC
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-gc-based-on-library-id-prefix" class="md-nav__link">
    Run GC based on library ID prefix
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gc-cleanup-script-for-community-version" class="md-nav__link">
    GC cleanup script for Community Version
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gc-in-the-seafile-docker-container" class="md-nav__link">
    GC in the seafile docker container
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/haiwen/seafile-admin-docs/blob/master/manual/maintain/seafile_gc.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="seafile-gc">Seafile GC<a class="headerlink" href="#seafile-gc" title="Permanent link">&para;</a></h1>
<p>Seafile uses storage de-duplication technology to reduce storage usage. The underlying data blocks will not be removed immediately after you delete a file or a library. As a result, the number of unused data blocks will increase on Seafile server.</p>
<p>To release the storage space occupied by unused blocks, you have to run a
"garbage collection" program to clean up unused blocks on your server.</p>
<p>The GC program cleans up two types of unused blocks:</p>
<ol>
<li>Blocks that no library references to, that is, the blocks belong to deleted libraries;</li>
<li>If you set history length limit on some libraries, the out-dated blocks in those libraries will also be removed.</li>
</ol>
<p><strong>Before running GC, you must shutdown the Seafile program on your server if you use the community edition. For professional edition, online GC operation is supported. If you use Professional edition, you don't need to shutdown the Seafile program if you are using MySQL.</strong>
This is because new blocks written into Seafile while GC is running may be mistakenly deleted by the GC program.</p>
<p>At the bottom of the page there is a script that you can use to run the cleanup manually or e.g. once a week with as cronjob.</p>
<h2 id="run-gc">Run GC<a class="headerlink" href="#run-gc" title="Permanent link">&para;</a></h2>
<h3 id="dry-run-mode">Dry-run Mode<a class="headerlink" href="#dry-run-mode" title="Permanent link">&para;</a></h3>
<p>To see how much garbage can be collected without actually removing any garbage, use the dry-run option:</p>
<div class="codehilite"><pre><span></span><code><span class="err">seaf-gc.sh --dry-run [repo-id1] [repo-id2] ...</span>
</code></pre></div>

<p>The output should look like:</p>
<div class="codehilite"><pre><span></span><code><span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">seafserv</span><span class="o">-</span><span class="n">gc</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">115</span><span class="p">):</span> <span class="n">GC</span> <span class="k">version</span> <span class="mi">1</span> <span class="n">repo</span> <span class="n">My</span> <span class="n">Library</span><span class="p">(</span><span class="n">ffa57d93</span><span class="p">)</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">394</span><span class="p">):</span> <span class="n">GC</span> <span class="n">started</span><span class="p">.</span> <span class="n">Total</span> <span class="n">block</span> <span class="nb">number</span> <span class="k">is</span> <span class="mi">265</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">75</span><span class="p">):</span> <span class="n">GC</span> <span class="k">index</span> <span class="k">size</span> <span class="k">is</span> <span class="mi">1024</span> <span class="n">Byte</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">408</span><span class="p">):</span> <span class="n">Populating</span> <span class="k">index</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">262</span><span class="p">):</span> <span class="n">Populating</span> <span class="k">index</span> <span class="k">for</span> <span class="n">repo</span> <span class="n">ffa57d93</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">308</span><span class="p">):</span> <span class="n">Traversed</span> <span class="mi">5</span> <span class="n">commits</span><span class="p">,</span> <span class="mi">265</span> <span class="n">blocks</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">440</span><span class="p">):</span> <span class="n">Scanning</span> <span class="n">unused</span> <span class="n">blocks</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">472</span><span class="p">):</span> <span class="n">GC</span> <span class="n">finished</span><span class="p">.</span> <span class="mi">265</span> <span class="n">blocks</span> <span class="n">total</span><span class="p">,</span> <span class="n">about</span> <span class="mi">265</span> <span class="n">reachable</span> <span class="n">blocks</span><span class="p">,</span> <span class="mi">0</span> <span class="n">blocks</span> <span class="n">can</span> <span class="n">be</span> <span class="n">removed</span><span class="p">.</span>

<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">seafserv</span><span class="o">-</span><span class="n">gc</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">115</span><span class="p">):</span> <span class="n">GC</span> <span class="k">version</span> <span class="mi">1</span> <span class="n">repo</span> <span class="n">aa</span><span class="p">(</span><span class="n">f3d0a8d0</span><span class="p">)</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">394</span><span class="p">):</span> <span class="n">GC</span> <span class="n">started</span><span class="p">.</span> <span class="n">Total</span> <span class="n">block</span> <span class="nb">number</span> <span class="k">is</span> <span class="mi">5</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">75</span><span class="p">):</span> <span class="n">GC</span> <span class="k">index</span> <span class="k">size</span> <span class="k">is</span> <span class="mi">1024</span> <span class="n">Byte</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">408</span><span class="p">):</span> <span class="n">Populating</span> <span class="k">index</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">262</span><span class="p">):</span> <span class="n">Populating</span> <span class="k">index</span> <span class="k">for</span> <span class="n">repo</span> <span class="n">f3d0a8d0</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">308</span><span class="p">):</span> <span class="n">Traversed</span> <span class="mi">8</span> <span class="n">commits</span><span class="p">,</span> <span class="mi">5</span> <span class="n">blocks</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">264</span><span class="p">):</span> <span class="n">Populating</span> <span class="k">index</span> <span class="k">for</span> <span class="n">sub</span><span class="o">-</span><span class="n">repo</span> <span class="mi">9217622</span><span class="n">a</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">308</span><span class="p">):</span> <span class="n">Traversed</span> <span class="mi">4</span> <span class="n">commits</span><span class="p">,</span> <span class="mi">4</span> <span class="n">blocks</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">440</span><span class="p">):</span> <span class="n">Scanning</span> <span class="n">unused</span> <span class="n">blocks</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">472</span><span class="p">):</span> <span class="n">GC</span> <span class="n">finished</span><span class="p">.</span> <span class="mi">5</span> <span class="n">blocks</span> <span class="n">total</span><span class="p">,</span> <span class="n">about</span> <span class="mi">9</span> <span class="n">reachable</span> <span class="n">blocks</span><span class="p">,</span> <span class="mi">0</span> <span class="n">blocks</span> <span class="n">can</span> <span class="n">be</span> <span class="n">removed</span><span class="p">.</span>

<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">seafserv</span><span class="o">-</span><span class="n">gc</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">115</span><span class="p">):</span> <span class="n">GC</span> <span class="k">version</span> <span class="mi">1</span> <span class="n">repo</span> <span class="n">test2</span><span class="p">(</span><span class="n">e7d26d93</span><span class="p">)</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">394</span><span class="p">):</span> <span class="n">GC</span> <span class="n">started</span><span class="p">.</span> <span class="n">Total</span> <span class="n">block</span> <span class="nb">number</span> <span class="k">is</span> <span class="mi">507</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">75</span><span class="p">):</span> <span class="n">GC</span> <span class="k">index</span> <span class="k">size</span> <span class="k">is</span> <span class="mi">1024</span> <span class="n">Byte</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">408</span><span class="p">):</span> <span class="n">Populating</span> <span class="k">index</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">262</span><span class="p">):</span> <span class="n">Populating</span> <span class="k">index</span> <span class="k">for</span> <span class="n">repo</span> <span class="n">e7d26d93</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">308</span><span class="p">):</span> <span class="n">Traversed</span> <span class="mi">577</span> <span class="n">commits</span><span class="p">,</span> <span class="mi">507</span> <span class="n">blocks</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">440</span><span class="p">):</span> <span class="n">Scanning</span> <span class="n">unused</span> <span class="n">blocks</span><span class="p">.</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">49</span><span class="p">]</span> <span class="n">gc</span><span class="o">-</span><span class="n">core</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">472</span><span class="p">):</span> <span class="n">GC</span> <span class="n">finished</span><span class="p">.</span> <span class="mi">507</span> <span class="n">blocks</span> <span class="n">total</span><span class="p">,</span> <span class="n">about</span> <span class="mi">507</span> <span class="n">reachable</span> <span class="n">blocks</span><span class="p">,</span> <span class="mi">0</span> <span class="n">blocks</span> <span class="n">can</span> <span class="n">be</span> <span class="n">removed</span><span class="p">.</span>

<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span> <span class="n">seafserv</span><span class="o">-</span><span class="n">gc</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">124</span><span class="p">):</span> <span class="o">===</span> <span class="n">Repos</span> <span class="n">deleted</span> <span class="k">by</span> <span class="n">users</span> <span class="o">===</span>
<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span> <span class="n">seafserv</span><span class="o">-</span><span class="n">gc</span><span class="p">.</span><span class="k">c</span><span class="p">(</span><span class="mi">145</span><span class="p">):</span> <span class="o">===</span> <span class="n">GC</span> <span class="k">is</span> <span class="n">finished</span> <span class="o">===</span>

<span class="p">[</span><span class="mi">03</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">15</span> <span class="mi">19</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span> <span class="n">Following</span> <span class="n">repos</span> <span class="n">have</span> <span class="n">blocks</span> <span class="k">to</span> <span class="n">be</span> <span class="n">removed</span><span class="p">:</span>
<span class="n">repo</span><span class="o">-</span><span class="n">id1</span>
<span class="n">repo</span><span class="o">-</span><span class="n">id2</span>
<span class="n">repo</span><span class="o">-</span><span class="n">id3</span>
</code></pre></div>

<p>If you give specific library ids, only those libraries will be checked; otherwise all libraries will be checked.</p>
<p>Notice that at the end of the output there is a "repos have blocks to be removed" section. It contains the list of librareis that have garbage blocks. Later when you run GC without --dry-run option, you can use these libraris ids as input arguments to GC program.</p>
<h3 id="removing-garbage">Removing Garbage<a class="headerlink" href="#removing-garbage" title="Permanent link">&para;</a></h3>
<p>To actually remove garbage blocks, run without the --dry-run option:</p>
<div class="codehilite"><pre><span></span><code><span class="err">seaf-gc.sh [repo-id1] [repo-id2] ...</span>
</code></pre></div>

<p>If libraries ids are specified, only those libraries will be checked for garbage.</p>
<p>As described before, there are two types of garbage blocks to be removed. Sometimes just removing the first type of blocks (those that belong to deleted libraries) is good enough. In this case, the GC program won't bother to check the libraries for outdated historic blocks. The "-r" option implements this feature:</p>
<div class="codehilite"><pre><span></span><code><span class="err">seaf-gc.sh -r</span>
</code></pre></div>

<p><strong>In Seafile version 4.1.1 and later, libraries deleted by the users are not immediately removed from the system. Instead, they're moved into a "trash" in the system admin page. Before they're cleared from the trash, their blocks won't be garbage collected.</strong></p>
<h3 id="using-multiple-threads-in-gc">Using Multiple Threads in GC<a class="headerlink" href="#using-multiple-threads-in-gc" title="Permanent link">&para;</a></h3>
<p>Since Pro server 5.1.0, you can specify the thread number in GC. By default,</p>
<ul>
<li>If storage backend is S3/Swift/Ceph, 10 threads are started to do the GC work.</li>
<li>If storage backend is file system, only 1 thread is started.</li>
</ul>
<p>You can specify the thread number in with "-t" option. "-t" option can be used together with all other options. Each thread will do GC on one library. For example, the following command will use 20 threads to GC all libraries:</p>
<div class="codehilite"><pre><span></span><code><span class="err">seaf-gc.sh -t 20</span>
</code></pre></div>

<p>Since the threads are concurrent, the output of each thread may mix with each others. Library ID is printed in each line of output.</p>
<h3 id="run-gc-based-on-library-id-prefix">Run GC based on library ID prefix<a class="headerlink" href="#run-gc-based-on-library-id-prefix" title="Permanent link">&para;</a></h3>
<p>Since GC usually runs quite slowly as it needs to traverse the entire library history. You can use multiple threads to run GC in parallel. For even larger deployments, it's also desirable to run GC on multiple server in parallel.</p>
<p>A simple pattern to divide the workload among multiple GC servers is to assign libraries to servers based on library ID. Since Pro edition 7.1.5, this is supported. You can add "--id-prefix" option to seaf-gc.sh, to specify the library ID prefix. For example, the below command will only process libraries having "a123" as ID prefix.</p>
<div class="codehilite"><pre><span></span><code><span class="err">seaf-gc.sh --id-prefix a123</span>
</code></pre></div>

<h2 id="gc-cleanup-script-for-community-version">GC cleanup script for Community Version<a class="headerlink" href="#gc-cleanup-script-for-community-version" title="Permanent link">&para;</a></h2>
<p>To use this script you need:</p>
<ul>
<li>Setup the seafile-service file at '/etc/init.d/seafile-server'</li>
<li>Files of seafile setup need to be owner by 'seafile:nogroup' or 'seafile:seafile'</li>
<li>Run the script with sudo or as root</li>
<li>Put the script into crontab of a root user</li>
</ul>
<p>Create the script file (change the location to your liking):</p>
<div class="codehilite"><pre><span></span><code><span class="err">touch /opt/haiwen/seafile/cleanupScript.sh</span>
</code></pre></div>

<p>Use your favorite text editor and paste the following code:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1">#####</span>
<span class="c1"># Uncomment the following line if you rather want to run the script manually.</span>
<span class="c1"># Display usage if the script is not run as root user</span>
<span class="c1">#        if [[ $USER != &quot;root&quot; ]]; then</span>
<span class="c1">#                echo &quot;This script must be run as root user!&quot;</span>
<span class="c1">#                exit 1</span>
<span class="c1">#        fi</span>
<span class="c1">#</span>
<span class="c1"># echo &quot;Super User detected!!&quot;</span>
<span class="c1"># read -p &quot;Press [ENTER] to start the procedure, this will stop the seafile server!!&quot;</span>
<span class="c1">#####</span>

<span class="c1"># stop the server</span>
<span class="nb">echo</span> Stopping the Seafile-Server...
systemctl stop seafile.service
systemctl stop seahub.service

<span class="nb">echo</span> Giving the server some <span class="nb">time</span> to shut down properly....
sleep <span class="m">20</span>

<span class="c1"># run the cleanup</span>
<span class="nb">echo</span> Seafile cleanup started...
sudo -u seafile <span class="nv">$pathtoseafile</span>/seafile-server-latest/seaf-gc.sh

<span class="nb">echo</span> Giving the server some time....
sleep <span class="m">10</span>

<span class="c1"># start the server again</span>
<span class="nb">echo</span> Starting the Seafile-Server...
systemctl start seafile.service
systemctl start seahub.service

<span class="nb">echo</span> Seafile cleanup <span class="k">done</span>!
</code></pre></div>
</td></tr></table>
<p>Make sure that the script has been given execution rights, to do that run this command.</p>
<div class="codehilite"><pre><span></span><code><span class="err">sudo chmod +x /path/to/yourscript.sh</span>
</code></pre></div>

<p>Then open crontab with the root user</p>
<div class="codehilite"><pre><span></span><code><span class="err">crontab -e</span>
</code></pre></div>

<p>Add the following line (change the location of your script accordingly!)</p>
<div class="codehilite"><pre><span></span><code><span class="err">0 2 * * Sun /opt/haiwen/seafile/cleanupScript.sh</span>
</code></pre></div>

<p>The script will then run every Sunday at 2:00 AM.</p>
<h2 id="gc-in-the-seafile-docker-container">GC in the <a href="https://github.com/haiwen/seafile-docker">seafile docker container</a><a class="headerlink" href="#gc-in-the-seafile-docker-container" title="Permanent link">&para;</a></h2>
<p>To perform garbage collection inside the seafile docker container, you must run the <code>/scripts/gc.sh</code> script. Simply run <code>docker exec &lt;whatever-your-seafile-container-is-called&gt; /scripts/gc.sh</code>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../seafile_fsck/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Seafile FSCK
              </div>
            </div>
          </a>
        
        
          <a href="../clean_database/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Clean database
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 seafile
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/haiwen/seafile-admin-docs/" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.0ac82a11.min.js"></script>
      <script src="../../assets/javascripts/bundle.f81dfb4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>